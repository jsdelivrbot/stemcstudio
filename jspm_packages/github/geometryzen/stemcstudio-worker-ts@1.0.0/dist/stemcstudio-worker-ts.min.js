/*! stemcstudio-worker-ts 2017-07-26 */
System.register("src/fp/mixin.js",[],function(a,b){"use strict";function c(a,b){var c=a;for(var d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);return c}b&&b.id;return a("mixin",c),{setters:[],execute:function(){}}}),System.registerDynamic("npm:editor-document@0.0.5/build/browser/index.js",[],!0,function(a,b,c){"format cjs";this||self;!function(a,d){d("object"==typeof b&&"undefined"!=typeof c?b:a.editorDocument=a.editorDocument||{})}(b,function(a){"use strict";function b(a,b,c){var d=b.start.row,e=b.start.column,f=a[d]||"";switch(b.action){case"insert":var g=b.lines;if(1===g.length)a[d]=f.substring(0,e)+b.lines[0]+f.substring(e);else{var h=[d,1];h=h.concat(b.lines),a.splice.apply(a,h),a[d]=f.substring(0,e)+a[d],a[d+b.lines.length-1]+=f.substring(e)}break;case"remove":var i=b.end.column,j=b.end.row;d===j?a[d]=f.substring(0,e)+f.substring(i):a.splice(d,j-d+1,f.substring(0,e)+a[j].substring(i))}}function c(a,b){return{row:a,column:b}}function d(a,b){return a.row>b.row?1:a.row<b.row?-1:a.column>b.column?1:a.column<b.column?-1:0}function e(a,b){return a.row===b.row&&a.column===b.column}function f(a,b){return{start:a,end:b}}function g(a){return e(a.start,a.end)}function h(a){return{row:a.row,column:a.column}}function i(a,b){return{row:a,column:b}}var j=function(){this.propagationStopped=!0},k=function(){this.defaultPrevented=!0},l=function(){function a(a){this.owner=a}return a.prototype._dispatchEvent=function(a,b){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var c=this._eventRegistry[a]||[],d=this._defaultHandlers[a];if(c.length||d){"object"==typeof b&&b||(b={}),b.type||(b.type=a),b.stopPropagation||(b.stopPropagation=j),b.preventDefault||(b.preventDefault=k),c=c.slice();for(var e=0;e<c.length&&(c[e](b,this.owner),!b.propagationStopped);e++);return d&&!b.defaultPrevented?d(b,this.owner):void 0}},a.prototype.hasListeners=function(a){var b=this._eventRegistry,c=b&&b[a];return c&&c.length>0},a.prototype._emit=function(a,b){return this._dispatchEvent(a,b)},a.prototype._signal=function(a,b){var c=(this._eventRegistry||{})[a];if(c){c=c.slice();for(var d=0,e=c;d<e.length;d++){var f=e[d];f(b,this.owner)}}},a.prototype.once=function(a,b){var c=this;b&&this.addEventListener(a,function d(){c.removeEventListener(a,d),b.apply(null,arguments)})},a.prototype.addEventListener=function(a,b,c){var d=this;this._eventRegistry=this._eventRegistry||{};var e=this._eventRegistry[a];return e||(e=this._eventRegistry[a]=[]),e.indexOf(b)===-1&&(c?e.unshift(b):e.push(b)),function(){d.removeEventListener(a,b,c)}},a.prototype.on=function(a,b,c){return this.addEventListener(a,b,c)},a.prototype.removeEventListener=function(a,b,c){this._eventRegistry=this._eventRegistry||{};var d=this._eventRegistry[a];if(d){var e=d.indexOf(b);e!==-1&&d.splice(e,1)}},a.prototype.off=function(a,b,c){return this.removeEventListener(a,b,c)},a.prototype.removeAllListeners=function(a){this._eventRegistry&&(this._eventRegistry[a]=[])},a}(),m=function(){function a(a){return a.replace(/\r\n|\r/g,"\n").split("\n")}function b(a){return a.split(/\r\n|\r|\n/)}return 0==="aaa".split(/a/).length?a:b}(),n="change",o="changeNewLineMode",p=function(){function a(a){this._lines=[],this._autoNewLine="",this._newLineMode="auto",this.refCount=1,this._lines=[""],this._eventBus=new l(this),0===a.length?this._lines=[""]:Array.isArray(a)?this.insertMergedLines({row:0,column:0},a):this.insert({row:0,column:0},a)}return a.prototype.destructor=function(){this._lines.length=0,this._eventBus=void 0},a.prototype.addRef=function(){return this.refCount++,this.refCount},a.prototype.release=function(){if(this.refCount--,0===this.refCount)this.destructor();else if(this.refCount<0)throw new Error("Document refCount is negative.");return this.refCount},a.prototype.setValue=function(a){var b=this.getLength()-1,d=c(0,0),e=c(b,this.getLine(b).length);this.remove(f(d,e)),this.insert({row:0,column:0},a)},a.prototype.getValue=function(){return this._lines.join(this.getNewLineCharacter())},a.prototype.eventBusOrThrow=function(){if(this._eventBus)return this._eventBus;throw new Error("Document is a zombie.")},a.prototype.$detectNewLine=function(a){var b=a.match(/^.*?(\r\n|\r|\n)/m);this._autoNewLine=b?b[1]:"\n",this.eventBusOrThrow()._signal(o)},a.prototype.getNewLineCharacter=function(){switch(this._newLineMode){case"windows":return"\r\n";case"unix":return"\n";default:return this._autoNewLine||"\n"}},a.prototype.setNewLineMode=function(a){this._newLineMode!==a&&(this._newLineMode=a,this.eventBusOrThrow()._signal(o))},a.prototype.getNewLineMode=function(){return this._newLineMode},a.prototype.isNewLine=function(a){return"\r\n"===a||"\r"===a||"\n"===a},a.prototype.getLine=function(a){return this._lines[a]||""},a.prototype.getLines=function(a,b){var c=b+1;return this._lines.slice(a,c)},a.prototype.getAllLines=function(){return this._lines.slice(0,this._lines.length)},a.prototype.getLength=function(){return this._lines.length},a.prototype.getTextRange=function(a){return this.getLinesForRange(a).join(this.getNewLineCharacter())},a.prototype.getLinesForRange=function(a){var b;if(a.start.row===a.end.row)b=[this.getLine(a.start.row).substring(a.start.column,a.end.column)];else{b=this.getLines(a.start.row,a.end.row),b[0]=(b[0]||"").substring(a.start.column);var c=b.length-1;a.end.row-a.start.row===c&&(b[c]=b[c].substring(0,a.end.column))}return b},a.prototype.insert=function(a,b){return this.getLength()<=1&&this.$detectNewLine(b),this.insertMergedLines(a,m(b))},a.prototype.insertInLine=function(a,b){var c=this.clippedPos(a.row,a.column),d=i(a.row,a.column+b.length);return this.applyDelta({start:c,end:d,action:"insert",lines:[b]},!0),h(d)},a.prototype.clippedPos=function(a,b){var c=this.getLength(),d=!1;void 0===a?a=c:a<0?a=0:a>=c&&(a=c-1,d=!0);var e=this.getLine(a);return d&&(b=e.length),b=Math.min(Math.max(b,0),e.length),{row:a,column:b}},a.prototype.on=function(a,b,c){return this.eventBusOrThrow().on(a,b,c)},a.prototype.off=function(a,b,c){return this.eventBusOrThrow().off(a,b,c)},a.prototype.addChangeListener=function(a){return this.on(n,a,!1)},a.prototype.addChangeNewLineModeListener=function(a){this.on(o,a,!1)},a.prototype.removeChangeListener=function(a){this.off(n,a)},a.prototype.removeChangeNewLineModeListener=function(a){this.off(o,a)},a.prototype.insertFullLines=function(a,b){a=Math.min(Math.max(a,0),this.getLength());var c=0;return a<this.getLength()?(b=b.concat([""]),c=0):(b=[""].concat(b),a--,c=this._lines[a].length),this.insertMergedLines({row:a,column:c},b)},a.prototype.insertMergedLines=function(a,b){var c=this.clippedPos(a.row,a.column),d={row:c.row+b.length-1,column:(1===b.length?c.column:0)+b[b.length-1].length};return this.applyDelta({start:c,end:d,action:"insert",lines:b}),h(d)},a.prototype.remove=function(a){var b=this.clippedPos(a.start.row,a.start.column),c=this.clippedPos(a.end.row,a.end.column);return this.applyDelta({start:b,end:c,action:"remove",lines:this.getLinesForRange({start:b,end:c})}),h(b)},a.prototype.removeInLine=function(a,b,c){var d=this.clippedPos(a,b),e=this.clippedPos(a,c);return this.applyDelta({start:d,end:e,action:"remove",lines:this.getLinesForRange({start:d,end:e})},!0),h(d)},a.prototype.removeFullLines=function(a,b){a=Math.min(Math.max(0,a),this.getLength()-1),b=Math.min(Math.max(0,b),this.getLength()-1);var d=b===this.getLength()-1&&a>0,e=b<this.getLength()-1,g=d?a-1:a,h=d?this.getLine(g).length:0,i=e?b+1:b,j=e?0:this.getLine(i).length,k=c(g,h),l=c(i,j),m=this.getLines(a,b);return this.applyDelta({start:k,end:l,action:"remove",lines:this.getLinesForRange(f(k,l))}),m},a.prototype.removeNewLine=function(a){a<this.getLength()-1&&a>=0&&this.applyDelta({start:i(a,this.getLine(a).length),end:i(a+1,0),action:"remove",lines:["",""]})},a.prototype.replace=function(a,b){if(0===b.length&&g(a))return a.end;var c=this.getTextRange(a);return b===c?a.end:(this.remove(a),this.insert(a.start,b))},a.prototype.applyDeltas=function(a){for(var b=0;b<a.length;b++)this.applyDelta(a[b])},a.prototype.revertDeltas=function(a){for(var b=a.length-1;b>=0;b--)this.revertDelta(a[b])},a.prototype.applyDelta=function(a,c){var d="insert"===a.action;(d?a.lines.length<=1&&!a.lines[0]:e(a.start,a.end))||(d&&a.lines.length>2e4&&this.$splitAndapplyLargeDelta(a,2e4),b(this._lines,a,c),this.eventBusOrThrow()._signal(n,a))},a.prototype.$splitAndapplyLargeDelta=function(a,b){for(var c=a.lines,d=c.length,e=a.start.row,f=a.start.column,g=0,h=0;;){g=h,h+=b-1;var j=c.slice(g,h);if(h>d){a.lines=j,a.start.row=e+g,a.start.column=f;break}j.push(""),this.applyDelta({start:i(e+g,f),end:i(e+h,f=0),action:a.action,lines:j},!0)}},a.prototype.revertDelta=function(a){this.applyDelta({start:h(a.start),end:h(a.end),action:"insert"===a.action?"remove":"insert",lines:a.lines.slice()})},a.prototype.indexToPosition=function(a,b){void 0===b&&(b=0);for(var c=this._lines,d=this.getNewLineCharacter().length,e=c.length,f=b||0;f<e;f++)if(a-=c[f].length+d,a<0)return{row:f,column:a+c[f].length+d};return{row:e-1,column:c[e-1].length}},a.prototype.positionToIndex=function(a,b){void 0===b&&(b=0);for(var c=this._lines,d=this.getNewLineCharacter().length,e=0,f=Math.min(a.row,c.length),g=b||0;g<f;++g)e+=c[g].length+d;return e+a.column},a}();a.applyDelta=b,a.Document=p,a.comparePositions=d,a.equalPositions=e,a.position=c,a.isEmptyRange=g,a.range=f,Object.defineProperty(a,"__esModule",{value:!0})})}),System.registerDynamic("npm:editor-document@0.0.5.js",["npm:editor-document@0.0.5/build/browser/index.js"],!0,function(a,b,c){this||self;c.exports=a("npm:editor-document@0.0.5/build/browser/index.js")}),System.register("src/lib/delayedCall.js",[],function(a,b){"use strict";function c(a,b){var c=null,d=function(){c=null,a()},e=function(a){null===c&&(c=setTimeout(d,a||b))};return e.delay=function(a){c&&clearTimeout(c),c=setTimeout(d,a||b)},e.schedule=e,e.call=function(){e.cancel(),a()},e.cancel=function(){c&&clearTimeout(c),c=null},e.isPending=function(){return null!==c},e}b&&b.id;return a("delayedCall",c),{setters:[],execute:function(){}}}),System.register("src/workers/Mirror.js",["editor-document","../lib/delayedCall"],function(a,b){"use strict";var c,d,e;b&&b.id;return{setters:[function(a){c=a},function(a){d=a}],execute:function(){e=function(){function a(a,b){void 0===b&&(b=500);var e=this;if("object"!=typeof a)throw new TypeError("host must be a WorkerCallback.");this.host=a,this.$timeout=b,this.doc=new c.Document("");var f=this.deferredUpdate=d.delayedCall(this.onUpdate.bind(this));a.on("change",function(a){return e.doc.applyDeltas(a.data),e.$timeout?f.schedule(e.$timeout):void e.onUpdate()})}return a.prototype.setTimeout=function(a){this.$timeout=a},a.prototype.setValue=function(a){this.doc.setValue(a),this.deferredUpdate.schedule(this.$timeout)},a.prototype.getValue=function(a){this.host.callback(this.doc.getValue(),a)},a.prototype.emitAnnotations=function(a){this.host.emit("annotations",a)},a.prototype.onUpdate=function(){},a.prototype.isPending=function(){return this.deferredUpdate.isPending()},a}(),a("Mirror",e)}}}),System.register("src/workers/TypeScriptWorker.js",["../fp/mixin","./Mirror"],function(a,b){"use strict";var c,d,e,f=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();b&&b.id;return{setters:[function(a){c=a},function(a){d=a}],execute:function(){e=function(a){function b(b){var c=a.call(this,b,500)||this;return c.setOptions(),c}return f(b,a),b.prototype.setOptions=function(a){this.options=a||{},this.doc.getValue()&&this.deferredUpdate.schedule(100)},b.prototype.changeOptions=function(a){c.mixin(this.options,a),this.doc.getValue()&&this.deferredUpdate.schedule(100)},b.prototype.onUpdate=function(){var a=[];this.emitAnnotations(a)},b}(d.Mirror),a("TypeScriptWorker",e)}}}),System.register("src/lib/event_emitter.js",[],function(a,b){"use strict";var c,d,e;b&&b.id;return{setters:[],execute:function(){c=function(){this.propagationStopped=!0},d=function(){this.defaultPrevented=!0},e=function(){function a(){}return a.prototype._dispatchEvent=function(a,b){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var e=this._eventRegistry[a]||[],f=this._defaultHandlers[a];if(e.length||f){"object"==typeof b&&b||(b={}),b.type||(b.type=a),b.stopPropagation||(b.stopPropagation=c),b.preventDefault||(b.preventDefault=d),e=e.slice();for(var g=0;g<e.length&&(e[g](b,this),!b.propagationStopped);g++);return f&&!b.defaultPrevented?f(b,this):void 0}},a.prototype._emit=function(a,b){return this._dispatchEvent(a,b)},a.prototype._signal=function(a,b){var c=(this._eventRegistry||{})[a];if(c){c=c.slice();for(var d=0,e=c.length;d<e;d++)c[d](b,this)}},a.prototype.once=function(a,b){var c=this;b&&this.addEventListener(a,function d(){c.removeEventListener(a,d),b.apply(null,arguments)})},a.prototype.setDefaultHandler=function(a,b){var c=this._defaultHandlers;if(c||(c=this._defaultHandlers={_disabled_:{}}),c[a]){var d=c[a],e=c._disabled_[a];e||(c._disabled_[a]=e=[]),e.push(d);var f=e.indexOf(b);f!==-1&&e.splice(f,1)}c[a]=b},a.prototype.removeDefaultHandler=function(a,b){var c=this._defaultHandlers;if(c){var d=c._disabled_[a];if(c[a]===b)d&&this.setDefaultHandler(a,d.pop());else if(d){var e=d.indexOf(b);e!==-1&&d.splice(e,1)}}},a.prototype.addEventListener=function(a,b,c){this._eventRegistry=this._eventRegistry||{};var d=this._eventRegistry[a];return d||(d=this._eventRegistry[a]=[]),d.indexOf(b)===-1&&(c?d.unshift(b):d.push(b)),b},a.prototype.on=function(a,b,c){return this.addEventListener(a,b,c)},a.prototype.removeEventListener=function(a,b){this._eventRegistry=this._eventRegistry||{};var c=this._eventRegistry[a];if(c){var d=c.indexOf(b);d!==-1&&c.splice(d,1)}},a.prototype.off=function(a,b){return this.removeEventListener(a,b)},a.prototype.removeAllListeners=function(a){this._eventRegistry&&(this._eventRegistry[a]=[])},a}(),a("EventEmitterClass",e)}}}),System.register("src/lib/Sender.js",["./event_emitter"],function(a,b){"use strict";var c,d,e=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();b&&b.id;return{setters:[function(a){c=a}],execute:function(){d=function(a){function b(b){var c=a.call(this)||this;return c.target=b,c}return e(b,a),b.prototype.callback=function(a,b){this.target.postMessage({type:"call",id:b,data:a})},b.prototype.emit=function(a,b){this.target.postMessage({type:"event",name:a,data:b})},b.prototype.resolve=function(a,b,c){var d={value:b,callbackId:c};this.emit(a,d)},b.prototype.reject=function(a,b,c){var d={err:""+b,callbackId:c};this.emit(a,d)},b}(c.EventEmitterClass),a("Sender",d)}}}),System.register("stemcstudio-worker-ts.js",["./src/workers/TypeScriptWorker","./src/lib/Sender"],function(a,b){"use strict";var c,d,e;b&&b.id;return{setters:[function(a){c=a},function(a){d=a}],execute:function(){e={get TypeScriptWorker(){return c.TypeScriptWorker},get Sender(){return d.Sender}},a("default",e)}}});