// tquery.js - https://github.com/jeromeetienne/tquery - MIT License
// tquery.js - https://github.com/jeromeetienne/tquery - MIT License
/**
 * @fileOverview This file is the core of tQuery library. 
*//**
 * Create a tQuery element
 *
 * @class root class
 * 
 * @param {} object
 * @param {THREE.Object3D} rootnode
 * @returns {tQuery.*} the tQuery object created
*/var tQuery=function(e,t){if(arguments.length===2&&(arguments[0]instanceof THREE.Geometry||arguments[0]instanceof THREE.BufferGeometry||arguments[0]instanceof tQuery.Geometry)&&(arguments[1]instanceof THREE.Material||arguments[1]instanceof tQuery.Material)){var n=arguments[0]instanceof tQuery.Geometry?arguments[0].get(0):arguments[0],r=arguments[1]instanceof tQuery.Material?arguments[1].get(0):arguments[1],i=new THREE.Mesh(n,r);return tQuery(i)}var s=Array.isArray(e)?e[0]:e;return s instanceof THREE.Mesh&&tQuery.Mesh?new tQuery.Mesh(e):s instanceof THREE.DirectionalLight&&tQuery.DirectionalLight?new tQuery.DirectionalLight(e):s instanceof THREE.AmbientLight&&tQuery.AmbientLight?new tQuery.AmbientLight(e):s instanceof THREE.Light&&tQuery.Light?new tQuery.Light(e):s instanceof THREE.Object3D&&tQuery.Object3D?new tQuery.Object3D(e):s instanceof THREE.Geometry&&tQuery.Geometry?new tQuery.Geometry(e):s instanceof THREE.Material&&tQuery.Material?new tQuery.Material(e):typeof s=="string"&&tQuery.Object3D?new tQuery.Object3D(e,t):(console.assert(!1,"unsupported type"),undefined)};tQuery.VERSION="r59.0",tQuery.data=function(e,t,n,r){return console.assert(e,"invalid parameters"),console.assert(typeof t=="string","invalid parameters"),r===undefined&&n!==undefined&&(r=!0),e._tqData=e._tqData||{},r&&console.assert(e._tqData[t]===undefined,"This key already exists "+t),n&&(e._tqData[t]=n),e._tqData[t]},tQuery.hasData=function(e,t){return e._tqData===undefined?!1:e._tqData[t]===undefined?!1:!0},tQuery.removeData=function(e,t,n){if(t instanceof Array){t.forEach(function(t){tQuery.removeData(e,t)});return}console.assert(typeof t=="string"),n&&console.assert(e._tqData[t]!==undefined,"This key doesnt already exists "+t),delete e._tqData[t]},tQuery.each=function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n,e);if(r===!1)return!1}return!0},tQuery.now=function(){var e=window.performance||{};return e.now?function(){return e.timing.navigationStart+e.now()}:e.mozNow?function(){return e.timing.navigationStart+e.mozNow()}:e.webkitNow?function(){return e.timing.navigationStart+e.webkitNow()}:e.mskitNow?function(){return e.timing.navigationStart+e.msNow()}:e.okitNow?function(){return e.timing.navigationStart+e.oNow()}:function(){return Date.now}}(),tQuery.nowSeconds=function(){return tQuery.now()/1e3},tQuery.inherit=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.parent=t.prototype,e.prototype.constructor=e},tQuery.extend=function(e,t,n){function s(e,t){Object.keys(t).forEach(function(n){e[n]=t[n]})}function o(e,t){for(var n in t)t[n]&&t[n].constructor&&t[n].constructor===Object?(e[n]=e[n]||{},arguments.callee(e[n],t[n])):e[n]=t[n];return e}n=n!==undefined?n:!0;var r=n?o:s,i={};return t&&r(i,t),e&&r(i,e),i},tQuery._pluginsOn=function(e,t,n){t=t||e.prototype||e,n=n||"",console.assert(e["register"+n]===undefined),console.assert(e["unregister"+n]===undefined),console.assert(e["registered"+n]===undefined),e["register"+n]=function(e,n){console.assert(t[e]===undefined,"Conflict! Already method called: "+e),t[e]=n},e["unregister"+n]=function(e){if(t.hasOwnProperty(e)===!1)throw new Error("Plugin not found: "+e);delete t[e]},e["registered"+n]=function(e){return t.hasOwnProperty(e)===!0}},tQuery.pluginsInstanceOn=function(e){tQuery._pluginsOn(e,undefined,"Instance")},tQuery.pluginsStaticOn=function(e){tQuery._pluginsOn(e,e,"Static")},tQuery.pluginsStaticOn(tQuery),tQuery.mixinAttributes=function(e,t){e.prototype._attrProps=tQuery.extend(e.prototype._attrProps,t),e.prototype.attr=function(e,t){e instanceof Object&&t===undefined?Object.keys(e).forEach(function(t){this.attr(t,e[t])}.bind(this)):typeof e=="string"?console.assert(Object.keys(this._attrProps).indexOf(e)!==-1,"invalid property name:"+e):console.assert(!1,"invalid parameter");if(t!==undefined){var n=this._attrProps[e],r=n.apply(n,t);return this.each(function(t){t[e]=r}),this}if(this.length===0)return undefined;var i=this.get(0);return i[e]},Object.keys(t).forEach(function(t){e.prototype[t]=function(){return this.attr(t,arguments)}}.bind(this))},tQuery.Flow=function(){var e,t=[],n=setTimeout(function(){n=null,e._next()},0);return e={destroy:function(){n&&clearTimeout(n)},par:function(n,r){return(r||!(t[t.length-1]instanceof Array))&&t.push([]),t[t.length-1].push(n),e},seq:function(t){return e.par(t,!0)},_next:function(n,r){var i=[],s=[],o=t.shift()||[],u=o.length,a=u==1;o&&o.forEach(function(t,o){t(function(t,n){i[o]=t,s[o]=n,--u==0&&e._next(a?i[0]:i,a?s[0]:s)},n,r)})}}},tQuery.MicroeventMixin=function(e){var t=function(e,t){return this._events===undefined&&(this._events={}),this._events[e]=this._events[e]||[],this._events[e].push(t),t},n=function(e,t){this._events===undefined&&(this._events={});if(e in this._events==0)return;this._events[e].splice(this._events[e].indexOf(t),1)},r=function(e){this._events===undefined&&(this._events={});if(this._events[e]===undefined)return;var t=this._events[e].slice();for(var n=0;n<t.length;n++){var r=t[n].apply(this,Array.prototype.slice.call(arguments,1));if(r!==undefined)return r}return undefined};return e.bind=t,e.unbind=n,e.trigger=r,e.addEventListener=function(e,t){return this.bind(e,t),this},e.removeEventListener=function(e,t){return this.unbind(e,t),this},e.dispatchEvent=function(e){return this.trigger.apply(this,arguments)},e},tQuery.MicroCache=function(){var e={};return{get:function(t){return e[t]},contains:function(t){return t in e},remove:function(t){delete e[t]},set:function(t,n){e[t]=n},values:function(){return e},getSet:function(e,t){return this.contains(e)||this.set(e,typeof t=="function"?t():t),this.get(e)}}},tQuery.mixinCreatorPattern=function(klass,name){var jsCode=["klass.create = (function() {","	function F(args) {","		return klass.apply(this, args);","	}","	F.prototype = klass.prototype;","	return function(){","		return new F(arguments);","	}","})()"].join("\n");name=name||klass.name,jsCode=name?jsCode.replace(/F/g,name):jsCode,eval(jsCode)},tQuery.convert={},tQuery.convert.toThreeColor=function(){var e=tQuery.convert.toThreeColor.dispatchEvent("preConvert",arguments);return e!==undefined?e:arguments.length===1&&typeof arguments[0]=="number"?new THREE.Color(arguments[0]):arguments.length===1&&typeof arguments[0]=="string"?new THREE.Color(arguments[0]):arguments.length===1&&arguments[0]instanceof THREE.Color?arguments[0]:arguments.length===3&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"&&typeof arguments[2]=="number"?(new THREE.Color).setRGB(arguments[0],arguments[1],arguments[2]):(console.assert(!1,"invalid parameter"),undefined)},tQuery.MicroeventMixin(tQuery.convert.toThreeColor),tQuery.convert.toThreeMaterial=function(){var e=tQuery.convert.toThreeMaterial.dispatchEvent("preConvert",arguments);return e!==undefined?e:arguments.length===1&&arguments[0]instanceof THREE.Material?arguments[0]:arguments.length===1&&arguments[0]instanceof tQuery.Material?arguments[0].get(0):(console.assert(!1,"invalid parameter"),undefined)},tQuery.MicroeventMixin(tQuery.convert.toThreeMaterial),tQuery.convert.toVector3=function(){if(arguments.length===0)return new THREE.Vector3;if(arguments[0]instanceof THREE.Vector3&&arguments.length===1)return arguments[0];if(typeof arguments[0]=="number"&&arguments.length===3)return new THREE.Vector3(arguments[0],arguments[1],arguments[2]);if(arguments[0]instanceof Array&&arguments.length===1)return new THREE.Vector3(arguments[0][0],arguments[0][1],arguments[0][2]);console.assert(!1,"invalid parameter for Vector3")},tQuery.convert.toVector2=function(){if(arguments[0]instanceof THREE.Vector2&&arguments.length===1)return arguments[0];if(typeof arguments[0]=="number"&&arguments.length===2)return new THREE.Vector2(arguments[0],arguments[1]);console.assert(!1,"invalid parameter for Vector2")},tQuery.convert.toNumber=function(e){return arguments.length===1&&typeof e=="number"?e:(console.assert(!1,"invalid parameter"),undefined)},tQuery.convert.toNumberZeroToOne=function(e){return arguments.length===1&&typeof e=="number"?(e=Math.min(e,1),e=Math.max(e,0),e):(console.assert(!1,"invalid parameter"),undefined)},tQuery.convert.toInteger=function(e){return arguments.length===1&&typeof e=="number"?(e=Math.floor(e),e):(console.assert(!1,"invalid parameter"),undefined)},tQuery.convert.identity=function(e){return e},tQuery.convert.toBoolean=function(e){return arguments.length===1&&typeof e=="boolean"?e:(console.assert(!1,"invalid parameter"),undefined)},tQuery.convert.toString=function(e){return arguments.length===1&&typeof e=="string"?e:(console.assert(!1,"invalid parameter"),undefined)},tQuery.convert.toTextureCube=function(){var e=this.dispatchEvent("preConvert",arguments);return e!==undefined?e:tQuery.convert.toTexture.apply(tQuery.convert.toTexture,arguments)},tQuery.MicroeventMixin(tQuery.convert.toTextureCube),tQuery.convert.toTexture=function(e){var t=this.dispatchEvent("preConvert",arguments);if(t!==undefined)return t;if(arguments.length===1&&e instanceof tQuery.Texture)return arguments[0].get(0);if(arguments.length===1&&e instanceof THREE.Texture)return e;if(arguments.length===1&&e instanceof THREE.WebGLRenderTarget)return e;if(arguments.length===1&&typeof e=="string")return THREE.ImageUtils.loadTexture(e);if(arguments.length===1&&(e instanceof Image||e instanceof HTMLVideoElement||e instanceof HTMLCanvasElement)){var n=new THREE.Texture(e);return n.needsUpdate=!0,n}return console.assert(!1,"invalid parameter"),undefined},tQuery.MicroeventMixin(tQuery.convert.toTexture),tQuery.Node=function(e){e instanceof Array?this._lists=e:e?this._lists=[e]:this._lists=[],this.length=this._lists.length},tQuery.Node.prototype.get=function(e){return e===undefined?this._lists:(console.assert(this._lists[e],"element not defined"),this._lists[e])},tQuery.Node.prototype.each=function(e){return tQuery.each(this._lists,e)},tQuery.Node.prototype.back=function(e){return e===undefined?this._back:(this._back=e,this)},tQuery.Node.prototype.data=function(e,t,n){return t!==undefined?(this.each(function(r){tQuery.data(r,e,t,n)}),this):this.length>0?tQuery.data(this.get(0),e):(console.assert(this.length===0),undefined)},tQuery.Node.prototype.removeData=function(e){return this.each(function(t){tQuery.removeData(t,e)}),this},tQuery.Object3D=function(e,t){typeof e=="string"&&(e=tQuery.Object3D._select(e,t)),tQuery.Object3D.parent.constructor.call(this,e),this._lists.forEach(function(e){console.assert(e instanceof THREE.Object3D)})},tQuery.inherit(tQuery.Object3D,tQuery.Node),tQuery.pluginsInstanceOn(tQuery.Object3D),tQuery.pluginsStaticOn(tQuery.Object3D),tQuery.mixinAttributes(tQuery.Object3D,{eulerOrder:tQuery.convert.toString,doubleSided:tQuery.convert.toBoolean,flipSided:tQuery.convert.toBoolean,rotationAutoUpdate:tQuery.convert.toBoolean,matrixAutoUpdate:tQuery.convert.toBoolean,matrixWorldNeedsUpdate:tQuery.convert.toBoolean,useQuaternion:tQuery.convert.toBoolean,visible:tQuery.convert.toBoolean,receiveShadow:tQuery.convert.toBoolean,castShadow:tQuery.convert.toBoolean}),tQuery.Object3D.prototype.traverse=function(e){return this.each(function(t){t.traverse(function(t){e(t,this)})}),this},tQuery.Object3D.prototype.geometry=function(e){var t=[];return this.each(function(e){t.push(e.geometry)}),(new tQuery.Geometry(t)).back(this)},tQuery.Object3D.prototype.material=function(){var e=[];return this.each(function(t){e.push(t.material)}),new tQuery.Material(e)},tQuery.Object3D.prototype.clone=function(){var e=[];return this.each(function(t){var n=t.clone();e.push(n)}),tQuery(e)},tQuery.Object3D.prototype.lookAt=function(e){return e=tQuery.convert.toVector3.apply(null,arguments),this.each(function(t){t.lookAt(e)}),this},tQuery.Object3D.prototype.addTo=function(e){return console.assert(e instanceof tQuery.World||e instanceof tQuery.Object3D||e instanceof THREE.Object3D),this.each(function(t){e.add(t)}.bind(this)),this},tQuery.Object3D.prototype.removeFrom=function(e){return console.assert(e instanceof tQuery.World||e instanceof tQuery.Object3D),this.each(function(t){e.remove(t)}.bind(this)),this},tQuery.Object3D.prototype.detach=function(){return this.each(function(e){if(!e.parent)return;e.parent.remove(e)}.bind(this)),this},tQuery.Object3D.prototype.add=function(e){return e instanceof tQuery.Object3D?this.each(function(t){e.each(function(e){t.add(e)})}.bind(this)):e instanceof THREE.Object3D?this.length>0?this.each(function(t){t.add(e)}):this._lists.push(e):console.assert(!1,"invalid parameter"),this},tQuery.Object3D.prototype.remove=function(e){return e instanceof tQuery.Object3D?this.each(function(t){e.each(function(e){t.remove(e)})}.bind(this)):e instanceof THREE.Object3D?this.each(function(t){t.remove(e)}):console.assert(!1,"invalid parameter"),this},tQuery.Object3D.prototype.name=function(e){console.assert(this.length<=1,"tQuery.Object3D.id used on multi-elements");if(e===undefined){if(this.length===0)return undefined;var t=this.get(0);return t.name}if(this.length===0)return undefined;var t=this.get(0);return t.name=e,this},tQuery.Object3D.prototype.id=function(e){console.assert(this.length<=1,"tQuery.Object3D.id used on multi-elements");if(e!==undefined){if(this.length>0){var t=this.get(0);t._tqId=e}return this}if(this.length>0){var t=this.get(0);return t._tqId}return undefined},tQuery.Object3D.prototype.addClass=function(e){return this.each(function(t){t._tqClasses=t._tqClasses||"";if(tQuery.Object3D._hasClassOne(t,e))return;t._tqClasses+=" "+e}.bind(this)),this},tQuery.Object3D.prototype.removeClass=function(e){return this.each(function(t){tQuery.Object3D._removeClassOne(t,e)}.bind(this)),this},tQuery.Object3D.prototype.hasClass=function(e){var t=this.each(function(t){t._tqClasses=t._tqClasses||"";var n=tQuery.Object3D._hasClassOne(t,e);return n?!1:!0}.bind(this));return t?!1:!0},tQuery.Object3D._hasClassOne=function(e,t){if(e._tqClasses===undefined)return!1;var n=e._tqClasses,r=new RegExp("(^| |	)+("+t+")($| |	)+");return n.match(r)?!0:!1},tQuery.Object3D._removeClassOne=function(e,t){if(e._tqClasses===undefined)return;var n=new RegExp("(^| |	)("+t+")($| |	)");e._tqClasses=e._tqClasses.replace(n," ")},tQuery.Object3D._select=function(e,t){t=t||tQuery.world.tScene(),t instanceof tQuery.Object3D&&(t=t.get(0));var n=e.split(" ").filter(function(e){return e.length>0});console.assert(t instanceof THREE.Object3D);var r=[];return t.children.forEach(function(e){var t=this._crawls(e,n);r=r.concat(t)}.bind(this)),r},tQuery.Object3D._crawls=function(e,t){var n=[];console.assert(t.length>=1);var r=this._selectItemMatch(e,t[0]),i=r?t.slice(1):t;return i.length===0?[e]:(e.children.forEach(function(e){var t=this._crawls(e,i);n=n.concat(t)}.bind(this)),n)},tQuery.Object3D._selectableGeometries=Object.keys(THREE).filter(function(e){return e.match(/.+Geometry$/)}).map(function(e){return e.replace(/Geometry$/,"").toLowerCase()}),tQuery.Object3D._selectableLights=Object.keys(THREE).filter(function(e){return e.match(/.+Light$/)}).map(function(e){return e.replace(/Light$/,"").toLowerCase()}),tQuery.Object3D._selectableClasses=["mesh","light"],tQuery.Object3D._selectItemMatch=function(e,t){console.assert(e instanceof THREE.Object3D),console.assert(typeof t=="string");var n=t.match(new RegExp("([^.#]+|.[^.#]+|#[^.#]+)","g")),r=tQuery.each(n,function(t){var n=t.charAt(0),r=t.slice(1);if(n==="."){var i=tQuery.Object3D._hasClassOne(e,r);return i?!0:!1}if(n==="#")return e._tqId===r?!0:!1;if(n==="["){var s=t.match(/\[(.*)([=])(.*)\]/),o=s[1],u=s[2],a=s[3].replace(/^['"]/,"").replace(/['"]$/,"");if(o==="name"){if(u==="=")return e.name===a?!0:!1;console.assert("operator not handled")}else console.assert(!1,"key not handled:",o);return console.assert(!1,"this point should never be reached"),undefined}if(t==="*")return!0;if(this._selectableGeometries.indexOf(t)!==-1){var f=e.geometry,l=t.charAt(0).toUpperCase()+t.slice(1)+"Geometry";return f instanceof THREE[l]}if(this._selectableLights.indexOf(t)!==-1){var l=t.charAt(0).toUpperCase()+t.slice(1)+"Light";return e instanceof THREE[l]}if(this._selectableClasses.indexOf(t)!==-1){var l=t.charAt(0).toUpperCase()+t.slice(1);return e instanceof THREE[l]}return console.assert(!1,"invalid selector: "+t),!0}.bind(this));return r?!0:!1},tQuery.Geometry=function(e){tQuery.Geometry.parent.constructor.call(this,e),this._lists.forEach(function(e){console.assert(e instanceof THREE.Geometry)})},tQuery.inherit(tQuery.Geometry,tQuery.Node),tQuery.pluginsInstanceOn(tQuery.Geometry),tQuery.mixinAttributes(tQuery.Geometry,{hasTangents:tQuery.convert.toBoolean,dynamic:tQuery.convert.toBoolean}),tQuery.Material=function(e){tQuery.Material.parent.constructor.call(this,e),this._lists.forEach(function(e){console.assert(e instanceof THREE.Material)})},tQuery.inherit(tQuery.Material,tQuery.Node),tQuery.pluginsInstanceOn(tQuery.Material),tQuery.mixinAttributes(tQuery.Material,{opacity:tQuery.convert.toNumber,transparent:tQuery.convert.toBoolean}),tQuery.Light=function(e){tQuery.Light.parent.constructor.call(this,e),this._lists.forEach(function(e){console.assert(e instanceof THREE.Light)})},tQuery.inherit(tQuery.Light,tQuery.Object3D),tQuery.pluginsInstanceOn(tQuery.Light),tQuery.mixinAttributes(tQuery.Light,{color:tQuery.convert.toThreeColor}),tQuery.Mesh=function(e){var t=tQuery.Mesh.parent;t.constructor.call(this,e),this._lists.forEach(function(e){console.assert(e instanceof THREE.Mesh)})},tQuery.inherit(tQuery.Mesh,tQuery.Object3D),tQuery.pluginsInstanceOn(tQuery.Mesh),tQuery.MicroeventMixin(tQuery.Mesh.prototype),tQuery.Mesh.prototype.material=function(e){var t=tQuery.Mesh.parent;return e===undefined?t.material.call(this):(e instanceof tQuery.Material&&(e=e.get(0)),console.assert(e instanceof THREE.Material||e instanceof THREE.FaceMaterial),this.each(function(t){t.material=e}),this)},tQuery.registerStatic("createSprite",function(e,t){arguments.length===1&&(e instanceof THREE.Material||e instanceof tQuery.Material)&&(t=tQuery.convert.toThreeMaterial(e),e=undefined);var n=new THREE.Sprite(e),r=new tQuery.Sprite(n);return t&&r.material(t),r}),tQuery.registerStatic("Sprite",function(e){tQuery.Sprite.parent.constructor.call(this,e),this._lists.forEach(function(e){console.assert(e instanceof THREE.Sprite)})}),tQuery.inherit(tQuery.Sprite,tQuery.Object3D),tQuery.pluginsInstanceOn(tQuery.Sprite),tQuery.mixinAttributes(tQuery.Sprite,{rotation:tQuery.convert.toNumber}),tQuery.Sprite.prototype.material=function(e){var t=tQuery.Sprite.parent;return e===undefined?t.material.call(this):(e instanceof tQuery.Material&&(e=e.get(0)),console.assert(e instanceof THREE.SpriteMaterial),this.each(function(t){t.material=e}),this)},tQuery.World=function(e){e=e||{},e=tQuery.extend(e,{renderW:window.innerWidth,renderH:window.innerHeight,webGLNeeded:!0,autoRendering:!0,scene:null,camera:null,renderer:null}),this._opts=e,console.assert(!tQuery.word),tQuery.world=this,this._autoRendering=e.autoRendering,this._tScene=e.scene||new THREE.Scene,e.camera?this._tCamera=e.camera:(this._tCamera=new THREE.PerspectiveCamera(45,e.renderW/e.renderH,.01,1e4),this._tCamera.position.set(0,0,3),this._tScene.add(this._tCamera)),this._loop=new tQuery.Loop,this._$loopCb=this._loop.hookOnRender(function(e,t){this.render(e)}.bind(this));if(e.renderer)this._tRenderer=e.renderer;else if(tQuery.World.hasWebGL())this._tRenderer=new THREE.WebGLRenderer({antialias:!0,preserveDrawingBuffer:!0}),this._tRenderer.setClearColor(12303291,1),this._tRenderer.setSize(e.renderW,e.renderH);else{if(!!e.webGLNeeded)throw this._addGetWebGLMessage(),new Error("WebGL required and not available");this._tRenderer=new THREE.CanvasRenderer,this._tRenderer.setClearColor(12303291,1),this._tRenderer.setSize(e.renderW,e.renderH)}},tQuery.pluginsInstanceOn(tQuery.World),tQuery.MicroeventMixin(tQuery.World.prototype),tQuery.World.prototype.destroy=function(){this.trigger("destroy"),this._loop.unhookOnRender(this._$loopCb),this._loop.destroy(),this.removeCameraControls();var e=this._tRenderer.domElement.parentElement;e&&e.removeChild(this._tRenderer.domElement),tQuery.world===this&&(tQuery.world=null)},tQuery.World._hasWebGL=undefined,tQuery.World.hasWebGL=function(){if(tQuery.World._hasWebGL!==undefined)return tQuery.World._hasWebGL;try{tQuery.World._hasWebGL=!!window.WebGLRenderingContext&&!!document.createElement("canvas").getContext("experimental-webgl")}catch(e){tQuery.World._hasWebGL=!1}return tQuery.World._hasWebGL},tQuery.World.prototype._addGetWebGLMessage=function(e){e=e||document.body;var t=document.createElement("div");t.style.fontFamily="monospace",t.style.fontSize="13px",t.style.textAlign="center",t.style.background="#eee",t.style.color="#000",t.style.padding="1em",t.style.width="475px",t.style.margin="5em auto 0",t.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/">here</a>.'].join("\n"):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/">here</a>.'].join("\n"),e.appendChild(t)},tQuery.World.prototype.setCameraControls=function(e){return this.hasCameraControls()&&this.removeCameraControls(),this._tCameraControls=e,this},tQuery.World.prototype.getCameraControls=function(){return this._tCameraControls},tQuery.World.prototype.removeCameraControls=function(){return this.hasCameraControls()===!1?this:(this._tCameraControls=undefined,this)},tQuery.World.prototype.hasCameraControls=function(){return this._tCameraControls!==undefined?!0:!1},tQuery.World.prototype.add=function(e){return e instanceof tQuery.Object3D?e.each(function(e){this._tScene.add(e)}.bind(this)):e instanceof THREE.Object3D?this._tScene.add(e):console.assert(!1,"invalid type"),this},tQuery.World.prototype.remove=function(e){return e instanceof tQuery.Object3D?e.each(function(e){this._tScene.remove(e)}.bind(this)):e instanceof THREE.Object3D?this._tScene.remove(e):console.assert(!1,"invalid type"),this},tQuery.World.prototype.appendTo=function(e){return e.appendChild(this._tRenderer.domElement),this},tQuery.World.prototype.start=function(){return this._loop.start(),this},tQuery.World.prototype.stop=function(){return this._loop.stop(),this},tQuery.World.prototype.hook=function(e,t){return this._loop.hook(e,t)},tQuery.World.prototype.unhook=function(e,t){return this._loop.unhook(e,t)},tQuery.World.prototype.loop=function(){return this._loop},tQuery.World.prototype.tRenderer=function(){return this._tRenderer},tQuery.World.prototype.tScene=function(){return this._tScene},tQuery.World.prototype.tCamera=function(){return this._tCamera},tQuery.World.prototype.scene=function(){return tQuery(this._tScene)},tQuery.World.prototype.camera=function(){return tQuery(this._tCamera)},tQuery.World.prototype.autoRendering=function(e){return e===undefined?this._autoRendering:(this._autoRendering=e,this)},tQuery.World.prototype.render=function(e){this.hasCameraControls()&&this._tCameraControls.update(e),this._autoRendering&&this._tRenderer.render(this._tScene,this._tCamera)},tQuery.Loop=function(){this._hooks=[],this._lastTime=null},tQuery.pluginsInstanceOn(tQuery.Loop),tQuery.Loop.prototype.destroy=function(){this.stop()},tQuery.Loop.prototype.start=function(){return this._timerId&&this.stop(),this._timerId=requestAnimationFrame(this._onAnimationFrame.bind(this)),this},tQuery.Loop.prototype.stop=function(){return cancelAnimationFrame(this._timerId),this._timerId=null,this},tQuery.Loop.prototype.isRunning=function(){return this._timerId?!0:!1},tQuery.Loop.prototype.pauseToggle=function(){return this.isRunning()?this.stop():this.start(),this},tQuery.Loop.maxDelta=.2,tQuery.Loop.prototype._onAnimationFrame=function(){this._timerId=requestAnimationFrame(this._onAnimationFrame.bind(this)),this.tick()},tQuery.Loop.prototype.tick=function(){var e=tQuery.nowSeconds();this._lastTime||(this._lastTime=e-1/60);var t=e-tQuery.Loop.maxDelta;this._lastTime<t&&(this._lastTime=t);var n=e-this._lastTime;this._lastTime=e;for(var r=0;r<=this._hooks.length;r++){if(this._hooks[r]===undefined)continue;var i=this._hooks[r].slice(0);for(var s=0;s<i.length;s++)i[s](n,e)}},tQuery.Loop.prototype.PRE_RENDER=20,tQuery.Loop.prototype.ON_RENDER=50,tQuery.Loop.prototype.POST_RENDER=80,tQuery.Loop.prototype.hook=function(e,t){return typeof e=="function"&&(t=e,e=this.PRE_RENDER),this._hooks[e]=this._hooks[e]||[],console.assert(this._hooks[e].indexOf(t)===-1),this._hooks[e].push(t),t},tQuery.Loop.prototype.unhook=function(e,t){typeof e=="function"&&(t=e,e=this.PRE_RENDER);var n=this._hooks[e].indexOf(t);return console.assert(n!==-1),this._hooks[e].splice(n,1),this._hooks[e].length===0&&delete this._hooks[e],this},tQuery.Loop.prototype.hookPreRender=function(e){return this.hook(this.PRE_RENDER,e)},tQuery.Loop.prototype.hookOnRender=function(e){return this.hook(this.ON_RENDER,e)},tQuery.Loop.prototype.hookPostRender=function(e){return this.hook(this.POST_RENDER,e)},tQuery.Loop.prototype.unhookPreRender=function(e){return this.unhook(this.PRE_RENDER,e)},tQuery.Loop.prototype.unhookOnRender=function(e){return this.unhook(this.ON_RENDER,e)},tQuery.Loop.prototype.unhookPostRender=function(e){return this.unhook(this.POST_RENDER,e)},tQuery.registerStatic("createWorld",function(e){return new tQuery.World(e)}),tQuery.registerStatic("createObject3D",function(){var e=new THREE.Object3D;return tQuery(e)}),tQuery.registerStatic("createVector3",function(e,t,n){return tQuery.convert.toVector3.apply(tQuery.convert,arguments)}),tQuery.registerStatic("createVector2",function(e,t){return new THREE.Vector2(e,t)}),tQuery.registerStatic("createHemisphereLight",function(){var e=new THREE.HemisphereLight;return new tQuery.HemisphereLight([e])}),tQuery.registerStatic("createDirectionalLight",function(){var e=new THREE.DirectionalLight;return new tQuery.DirectionalLight([e])}),tQuery.registerStatic("createSpotLight",function(){var e=new THREE.SpotLight;return new tQuery.SpotLight([e])}),tQuery.registerStatic("createPointLight",function(){var e=new THREE.PointLight;return new tQuery.PointLight([e])}),tQuery.registerStatic("createAmbientLight",function(){var e=new THREE.AmbientLight;return new tQuery.AmbientLight([e])}),tQuery.registerStatic("defaultObject3DMaterial",new THREE.MeshNormalMaterial),tQuery.Geometry.prototype.toMesh=function(e){var t=[];return this.each(function(n){e=e||tQuery.defaultObject3DMaterial;var r=new THREE.Mesh(n,e);t.push(r)}),new tQuery.Mesh(t)},tQuery.registerStatic("createCube",function(){var e=THREE.CubeGeometry,t=[1,1,1];return this._createMesh(e,t,arguments)}),tQuery.registerStatic("createTorus",function(){var e=THREE.TorusGeometry,t=[.35,.15];return this._createMesh(e,t,arguments)}),tQuery.registerStatic("createTorusKnot",function(){var e=THREE.TorusKnotGeometry,t=[.27,.1,128,32];return this._createMesh(e,t,arguments)}),tQuery.registerStatic("createCircle",function(){var e=THREE.CircleGeometry,t=[.5,32];return this._createMesh(e,t,arguments)}),tQuery.registerStatic("createSphere",function(){var e=THREE.SphereGeometry,t=[.5,32,16];return this._createMesh(e,t,arguments)}),tQuery.registerStatic("createPlane",function(){var e=THREE.PlaneGeometry,t=[1,1,16,16];return this._createMesh(e,t,arguments)}),tQuery.registerStatic("createCylinder",function(){var e=THREE.CylinderGeometry,t=[.5,.5,1,16,4];return this._createMesh(e,t,arguments)}),tQuery.registerStatic("_createMesh",function(e,t,n){n=Array.prototype.slice.call(n);var r=tQuery.defaultObject3DMaterial;n.length&&n[n.length-1]instanceof THREE.Material?r=n.pop():n.length&&n[n.length-1]instanceof tQuery.Material&&(r=n.pop().get(0));var i=function(e,t,n,r,i,s,o,u,a){return console.assert(arguments.length<=9),new e(t,n,r,i,s,o,u,a)};n.length===0&&(n=t.slice()),n.unshift(e);var s=i.apply(this,n);s.dynamic=!0;var o=new THREE.Mesh(s,r);return tQuery(o)}),tQuery.registerStatic("createAxis",function(){var e=new THREE.AxisHelper;return tQuery(e)}),tQuery.AmbientLight=function(e){tQuery.AmbientLight.parent.constructor.call(this,e),this._lists.forEach(function(e){console.assert(e instanceof THREE.AmbientLight)})},tQuery.inherit(tQuery.AmbientLight,tQuery.Light),tQuery.pluginsInstanceOn(tQuery.AmbientLight),tQuery.DirectionalLight=function(e){tQuery.DirectionalLight.parent.constructor.call(this,e),this._lists.forEach(function(e){console.assert(e instanceof THREE.DirectionalLight)})},tQuery.inherit(tQuery.DirectionalLight,tQuery.Light),tQuery.pluginsInstanceOn(tQuery.DirectionalLight),tQuery.mixinAttributes(tQuery.DirectionalLight,{intensity:tQuery.convert.toNumber,distance:tQuery.convert.toNumber,shadowDarkness:tQuery.convert.toNumberZeroToOne,shadowBias:tQuery.convert.toNumber,shadowMapWidth:tQuery.convert.toInteger,shadowMapHeight:tQuery.convert.toInteger,shadowCameraRight:tQuery.convert.toNumber,shadowCameraLeft:tQuery.convert.toNumber,shadowCameraTop:tQuery.convert.toNumber,shadowCameraBottom:tQuery.convert.toNumber,shadowCameraVisible:tQuery.convert.toBoolean,shadowCameraNear:tQuery.convert.toNumber,shadowCameraFar:tQuery.convert.toNumber}),tQuery.HemisphereLight=function(e){tQuery.HemisphereLight.parent.constructor.call(this,e),this._lists.forEach(function(e){console.assert(e instanceof THREE.HemisphereLight)})},tQuery.inherit(tQuery.HemisphereLight,tQuery.Light),tQuery.pluginsInstanceOn(tQuery.HemisphereLight),tQuery.mixinAttributes(tQuery.HemisphereLight,{intensity:tQuery.convert.toNumber,distance:tQuery.convert.toNumber,groundColor:tQuery.convert.toThreeColor}),tQuery.PointLight=function(e){tQuery.PointLight.parent.constructor.call(this,e),this._lists.forEach(function(e){console.assert(e instanceof THREE.PointLight)})},tQuery.inherit(tQuery.PointLight,tQuery.Light),tQuery.pluginsInstanceOn(tQuery.PointLight),tQuery.mixinAttributes(tQuery.PointLight,{intensity:tQuery.convert.toNumber,distance:tQuery.convert.toNumber}),tQuery.SpotLight=function(e){tQuery.SpotLight.parent.constructor.call(this,e),this._lists.forEach(function(e){console.assert(e instanceof THREE.SpotLight)})},tQuery.inherit(tQuery.SpotLight,tQuery.Light),tQuery.pluginsInstanceOn(tQuery.SpotLight),tQuery.mixinAttributes(tQuery.SpotLight,{intensity:tQuery.convert.toNumber,distance:tQuery.convert.toNumber,angle:tQuery.convert.toNumber,exponent:tQuery.convert.toNumber,onlyShadow:tQuery.convert.toBoolean,shadowDarkness:tQuery.convert.toNumberZeroToOne,shadowBias:tQuery.convert.toNumber,shadowMapWidth:tQuery.convert.toInteger,shadowMapHeight:tQuery.convert.toInteger,shadowCameraRight:tQuery.convert.toNumber,shadowCameraLeft:tQuery.convert.toNumber,shadowCameraTop:tQuery.convert.toNumber,shadowCameraBottom:tQuery.convert.toNumber,shadowCameraVisible:tQuery.convert.toBoolean,shadowCameraNear:tQuery.convert.toNumber,shadowCameraFar:tQuery.convert.toNumber}),tQuery.Mesh.registerInstance("setBasicMaterial",function(e){var t=tQuery.createMeshBasicMaterial(e);return this.material(t.get(0)),t.back(this)}),tQuery.registerStatic("createMeshBasicMaterial",function(e){var t=new THREE.MeshBasicMaterial(e),n=new tQuery.MeshBasicMaterial(t);return n}),tQuery.MeshBasicMaterial=function(e){tQuery.MeshBasicMaterial.parent.constructor.call(this,e),this._lists.forEach(function(e){console.assert(e instanceof THREE.MeshBasicMaterial)})},tQuery.inherit(tQuery.MeshBasicMaterial,tQuery.Material),tQuery.mixinAttributes(tQuery.MeshBasicMaterial,{color:tQuery.convert.toThreeColor,ambient:tQuery.convert.toThreeColor,map:tQuery.convert.toTexture,envMap:tQuery.convert.toTextureCube,refractionRatio:tQuery.convert.toNumber,blending:tQuery.convert.toNumber,side:tQuery.convert.identity,wireframe:tQuery.convert.toBoolean,wireframeLinewidth:tQuery.convert.toInteger,wireframeLinecap:tQuery.convert.toString}),tQuery.Mesh.registerInstance("setLambertMaterial",function(e){var t=tQuery.createMeshLambertMaterial(e);return this.material(t.get(0)),t.back(this)}),tQuery.registerStatic("createMeshLambertMaterial",function(e){var t=new THREE.MeshLambertMaterial(e),n=new tQuery.MeshLambertMaterial(t);return n}),tQuery.MeshLambertMaterial=function(e){tQuery.MeshLambertMaterial.parent.constructor.call(this,e),this._lists.forEach(function(e){console.assert(e instanceof THREE.MeshLambertMaterial)})},tQuery.inherit(tQuery.MeshLambertMaterial,tQuery.Material),tQuery.mixinAttributes(tQuery.MeshLambertMaterial,{color:tQuery.convert.toThreeColor,ambient:tQuery.convert.toThreeColor,map:tQuery.convert.toTexture,bumpMap:tQuery.convert.toTexture,bumpScale:tQuery
.convert.toNumber,side:tQuery.convert.identity}),tQuery.Mesh.registerInstance("setNormalMaterial",function(e){var t=tQuery.createMeshNormalMaterial(e);return this.material(t.get(0)),t.back(this)}),tQuery.registerStatic("createMeshNormalMaterial",function(e){var t=new THREE.MeshNormalMaterial(e),n=new tQuery.MeshNormalMaterial(t);return n}),tQuery.MeshNormalMaterial=function(e){tQuery.MeshNormalMaterial.parent.constructor.call(this,e),this._lists.forEach(function(e){console.assert(e instanceof THREE.MeshNormalMaterial)})},tQuery.inherit(tQuery.MeshNormalMaterial,tQuery.Material),tQuery.Mesh.registerInstance("setPhongMaterial",function(e){var t=tQuery.createMeshPhongMaterial(e);return this.material(t.get(0)),t.back(this)}),tQuery.registerStatic("createMeshPhongMaterial",function(e){var t=new THREE.MeshPhongMaterial(e),n=new tQuery.MeshPhongMaterial(t);return n}),tQuery.MeshPhongMaterial=function(e){tQuery.MeshPhongMaterial.parent.constructor.call(this,e),this._lists.forEach(function(e){console.assert(e instanceof THREE.MeshPhongMaterial)})},tQuery.inherit(tQuery.MeshPhongMaterial,tQuery.Material),tQuery.mixinAttributes(tQuery.MeshPhongMaterial,{map:tQuery.convert.toTexture,color:tQuery.convert.toThreeColor,ambient:tQuery.convert.toThreeColor,emissive:tQuery.convert.toThreeColor,specular:tQuery.convert.toThreeColor,shininess:tQuery.convert.toNumber,envMap:tQuery.convert.toTexture,refractionRatio:tQuery.convert.toNumber,reflectivity:tQuery.convert.toNumber,bumpMap:tQuery.convert.toTexture,bumpScale:tQuery.convert.toNumber,metal:tQuery.convert.toBoolean,perPixel:tQuery.convert.toBoolean}),tQuery.Sprite.registerInstance("setSpriteMaterial",function(e){var t=tQuery.createSpriteMaterial(e).back(this);return this.material(t.get(0)),t}),tQuery.registerStatic("createSpriteMaterial",function(e){e=tQuery.extend(e,{useScreenCoordinates:!1});var t=new THREE.SpriteMaterial(e),n=new tQuery.SpriteMaterial(t);return n}),tQuery.SpriteMaterial=function(e){tQuery.SpriteMaterial.parent.constructor.call(this,e),this._lists.forEach(function(e){console.assert(e instanceof THREE.SpriteMaterial)})},tQuery.inherit(tQuery.SpriteMaterial,tQuery.Material),tQuery.mixinAttributes(tQuery.SpriteMaterial,{color:tQuery.convert.toThreeColor,map:tQuery.convert.toTexture,useScreenCoordinates:tQuery.convert.toBoolean,depthTest:tQuery.convert.toBoolean,sizeAttenuation:tQuery.convert.toBoolean,scaleByViewport:tQuery.convert.toBoolean,fog:tQuery.convert.toBoolean,opacity:tQuery.convert.toNumber,blending:tQuery.convert.toNumber}),function(){tQuery.Geometry.registerInstance("computeAll",function(){return this.each(function(e){e.computeBoundingSphere(),e.computeBoundingBox(),e.computeCentroids(),e.computeFaceNormals(),e.computeVertexNormals()}),this}),tQuery.Geometry.registerInstance("scaleBy",function(e){return typeof e=="number"&&arguments.length===1?e=new THREE.Vector3(e,e,e):typeof e=="number"&&arguments.length===3&&(e=new THREE.Vector3(arguments[0],arguments[1],arguments[2])),console.assert(e instanceof THREE.Vector3,"Geometry.vector3 parameter error"),this.each(function(t){for(var n=0;n<t.vertices.length;n++){var r=t.vertices[n];r.multiply(e)}t.verticesNeedUpdate=!0,t.computeBoundingBox()}),this}),tQuery.Geometry.registerInstance("size",function(){console.assert(this.length<=1);if(this.length===0)return undefined;var e=this.get(0),t=new THREE.Vector3;return t.x=e.boundingBox.max.x-e.boundingBox.min.x,t.y=e.boundingBox.max.y-e.boundingBox.min.y,t.z=e.boundingBox.max.z-e.boundingBox.min.z,t}),tQuery.Geometry.registerInstance("normalize",function(){return this.each(function(e){var t=tQuery(e),n=t.size();n.x>=n.y&&n.x>=n.z?t.zoom(1/n.x):n.y>=n.x&&n.y>=n.z?t.zoom(1/n.y):t.zoom(1/n.z)}),this}),tQuery.Geometry.registerInstance("middlePoint",function(){console.assert(this.length<=1);if(this.length===0)return undefined;var e=this.get(0),t=new THREE.Vector3;return t.x=(e.boundingBox.max.x+e.boundingBox.min.x)/2,t.y=(e.boundingBox.max.y+e.boundingBox.min.y)/2,t.z=(e.boundingBox.max.z+e.boundingBox.min.z)/2,t}),tQuery.Geometry.registerInstance("translate",function(e){return typeof e=="number"&&arguments.length===3&&(e=new THREE.Vector3(arguments[0],arguments[1],arguments[2])),console.assert(e instanceof THREE.Vector3,"Geometry.translate parameter error"),this.each(function(t){for(var n=0;n<t.vertices.length;n++){var r=t.vertices[n];r.add(e)}t.verticesNeedUpdate=!0,t.computeBoundingBox()}),this}),tQuery.Geometry.registerInstance("rotate",function(e,t){typeof e=="number"&&arguments.length===3&&(e=new THREE.Vector3(arguments[0],arguments[1],arguments[2])),console.assert(e instanceof THREE.Vector3,"Geometry.rotate parameter error"),t=t||"XYZ";var n=new THREE.Matrix4;return n.makeRotationFromEuler(e,t),this.each(function(e){e.applyMatrix(n),e.verticesNeedUpdate=!0,e.computeBoundingBox()}),this}),tQuery.Geometry.registerInstance("center",function(e,t,n){return this.each(function(r){var i=tQuery(r),s=i.middlePoint().negate();return e&&(s.x=0),t&&(s.y=0),n&&(s.z=0),i.translate(s)}),this}),tQuery.Geometry.registerInstance("translateX",function(e){return this.translate(e,0,0)}),tQuery.Geometry.registerInstance("translateY",function(e){return this.translate(0,e,0)}),tQuery.Geometry.registerInstance("translateZ",function(e){return this.translate(0,0,e)}),tQuery.Geometry.registerInstance("rotateX",function(e){return this.rotate(e,0,0)}),tQuery.Geometry.registerInstance("rotateY",function(e){return this.rotate(0,e,0)}),tQuery.Geometry.registerInstance("rotateZ",function(e){return this.rotate(0,0,e)}),tQuery.Geometry.registerInstance("scaleXBy",function(e){return this.scaleBy(e,1,1)}),tQuery.Geometry.registerInstance("scaleYBy",function(e){return this.scaleBy(1,e,1)}),tQuery.Geometry.registerInstance("scaleZBy",function(e){return this.scaleBy(1,1,e)}),tQuery.Geometry.registerInstance("zoom",function(e){return this.scaleBy(e)}),tQuery.Geometry.registerInstance("zoomX",function(e){return this.zoom(e,1,1)}),tQuery.Geometry.registerInstance("zoomY",function(e){return this.zoom(1,e,1)}),tQuery.Geometry.registerInstance("zoomZ",function(e){return this.zoom(1,1,e)})}(),tQuery.Object3D.registerInstance("position",function(e){return e===undefined?this.get(0).position:(e=tQuery.convert.toVector3.apply(null,arguments),this.each(function(t){t.position.copy(e)}),this)}),tQuery.Object3D.registerInstance("positionX",function(e){return e===undefined?this.get(0).position.x:(console.assert(typeof e=="number"&&arguments.length===1),this.each(function(t){t.position.x=e}),this)}),tQuery.Object3D.registerInstance("positionY",function(e){return e===undefined?this.get(0).position.y:(console.assert(typeof e=="number"&&arguments.length===1),this.each(function(t){t.position.y=e}),this)}),tQuery.Object3D.registerInstance("positionZ",function(e){return e===undefined?this.get(0).position.z:(console.assert(typeof e=="number"&&arguments.length===1),this.each(function(t){t.position.z=e}),this)}),tQuery.Object3D.registerInstance("translate",function(e){return typeof e=="number"&&arguments.length===3&&(e=new THREE.Vector3(arguments[0],arguments[1],arguments[2])),console.assert(e instanceof THREE.Vector3,"Object3D.translate parameter error"),this.each(function(t){t.position.add(e)}),this}),tQuery.Object3D.registerInstance("translateX",function(e){return this.translate(e,0,0)}),tQuery.Object3D.registerInstance("translateY",function(e){return this.translate(0,e,0)}),tQuery.Object3D.registerInstance("translateZ",function(e){return this.translate(0,0,e)}),tQuery.Object3D.registerInstance("rotation",function(e){return e===undefined?this.get(0).rotation:(typeof e=="number"&&arguments.length===3&&(e=new THREE.Vector3(arguments[0],arguments[1],arguments[2])),console.assert(e instanceof THREE.Vector3,"Object3D.rotation parameter error"),this.each(function(t){t.rotation.x=e.x,t.rotation.y=e.y,t.rotation.z=e.z}),this)}),tQuery.Object3D.registerInstance("rotationX",function(e){return e===undefined?this.get(0).rotation.x:(console.assert(typeof e=="number"&&arguments.length===1),this.each(function(t){t.rotation.x=e}),this)}),tQuery.Object3D.registerInstance("rotationY",function(e){return e===undefined?this.get(0).rotation.y:(console.assert(typeof e=="number"&&arguments.length===1),this.each(function(t){t.rotation.y=e}),this)}),tQuery.Object3D.registerInstance("rotationZ",function(e){return e===undefined?this.get(0).rotation.z:(console.assert(typeof e=="number"&&arguments.length===1),this.each(function(t){t.rotation.z=e}),this)}),tQuery.Object3D.registerInstance("rotate",function(e){return typeof e=="number"&&arguments.length===3&&(e=new THREE.Vector3(arguments[0],arguments[1],arguments[2])),console.assert(e instanceof THREE.Vector3,"Object3D.rotate parameter error"),this.each(function(t){t.rotation.x+=e.x,t.rotation.y+=e.y,t.rotation.z+=e.z}),this}),tQuery.Object3D.registerInstance("rotateX",function(e){return this.rotate(e,0,0)}),tQuery.Object3D.registerInstance("rotateY",function(e){return this.rotate(0,e,0)}),tQuery.Object3D.registerInstance("rotateZ",function(e){return this.rotate(0,0,e)}),tQuery.Object3D.registerInstance("scale",function(e){return e===undefined?this.get(0).scale:(typeof e=="number"&&arguments.length===1?e=new THREE.Vector3(e,e,e):typeof e=="number"&&arguments.length===3&&(e=new THREE.Vector3(arguments[0],arguments[1],arguments[2])),console.assert(e instanceof THREE.Vector3,"Object3D.scale parameter error"),this.each(function(t){t.scale.copy(e)}),this)}),tQuery.Object3D.registerInstance("scaleX",function(e){return e===undefined?this.get(0).scale.x:(console.assert(typeof e=="number"&&arguments.length===1),this.each(function(t){t.scale.x=e}),this)}),tQuery.Object3D.registerInstance("scaleY",function(e){return e===undefined?this.get(0).scale.y:(console.assert(typeof e=="number"&&arguments.length===1),this.each(function(t){t.scale.y=e}),this)}),tQuery.Object3D.registerInstance("scaleZ",function(e){return e===undefined?this.get(0).scale.z:(console.assert(typeof e=="number"&&arguments.length===1),this.each(function(t){t.scale.z=e}),this)}),tQuery.Object3D.registerInstance("scaleBy",function(e){return typeof e=="number"&&arguments.length===1?e=new THREE.Vector3(e,e,e):typeof e=="number"&&arguments.length===3&&(e=new THREE.Vector3(arguments[0],arguments[1],arguments[2])),console.assert(e instanceof THREE.Vector3,"Object3D.rotate parameter error"),this.each(function(t){t.scale.multiply(e)}),this}),tQuery.Object3D.registerInstance("scaleXBy",function(e){return this.scaleBy(e,1,1)}),tQuery.Object3D.registerInstance("scaleYBy",function(e){return this.scaleBy(1,e,1)}),tQuery.Object3D.registerInstance("scaleZBy",function(e){return this.scaleBy(1,1,e)}),tQuery.Texture=function(e){tQuery.Texture.parent.constructor.call(this,e),this._lists.forEach(function(e){console.assert(e instanceof THREE.Texture)})},tQuery.inherit(tQuery.Texture,tQuery.Node),tQuery.pluginsStaticOn(tQuery.Texture),tQuery.pluginsInstanceOn(tQuery.Texture),tQuery.mixinAttributes(tQuery.Texture,{offset:tQuery.convert.toVector2,repeat:tQuery.convert.toVector2});