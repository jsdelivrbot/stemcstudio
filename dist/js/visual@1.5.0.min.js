var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},visual;!function(a){var b=function(a){function b(b,c,d,e,f,g){a.call(this),d=d||12,e=e||0,f=f||2*Math.PI;var h,i,j,k,l=Math.abs(2*Math.PI-Math.abs(f-e))<1e-4,m=l?d:d+1,n=1/d,o=(f-e)*n;for(h=0,j=m;j>h;h++){var p=e+h*o,q=p/2,r=Math.cos(q),s=Math.sin(q),t=new THREE.Quaternion(c.x*s,c.y*s,c.z*s,r);for(i=0,k=b.length;k>i;i++){var u=b[i],v=new THREE.Vector3(u.x,u.y,u.z);v.applyQuaternion(t),g&&v.applyQuaternion(g),this.vertices.push(v)}}var w=1/(b.length-1),x=b.length,y=x*m;for(h=0,j=d;j>h;h++)for(i=0,k=b.length-1;k>i;i++){var z=i+x*h,A=z%y,B=(z+x)%y,C=(z+1+x)%y,D=(z+1)%y,E=h*n,F=i*w,G=E+n,H=F+w;this.faces.push(new THREE.Face3(D,B,A)),this.faceVertexUvs[0].push([new THREE.Vector2(E,F),new THREE.Vector2(G,F),new THREE.Vector2(E,H)]),this.faces.push(new THREE.Face3(D,C,B)),this.faceVertexUvs[0].push([new THREE.Vector2(G,F),new THREE.Vector2(G,H),new THREE.Vector2(E,H)])}this.computeFaceNormals(),this.computeVertexNormals()}return __extends(b,a),b}(THREE.Geometry);a.RevolutionGeometry=b}(visual||(visual={}));var visual;!function(a){var b=function(a){function b(b,c,d,e,f,g,h,i){b=b||1,c=c||new THREE.Quaternion(0,0,0,1),e=(e||1)*b,f=(f||.01)*b,g=(g||.08)*b,h=(h||.2)*b,i=i||new THREE.Vector3(0,0,1);var j=e-h,k=e/2,l=function(a){return a.x?2:a.y?1:0},m=function(a){return a.x>0?1:a.x<0?-1:a.y>0?1:a.y<0?-1:a.z>0?1:a.z<0?-1:0},n=function(a){var b=l(a),c=m(a),d=(b+0)%3,e=(b+1)%3,h=(b+2)%3,i=[[0,0,k*c],[g,0,(j-k)*c],[f,0,(j-k)*c],[f,0,-k*c],[0,0,-k*c]],n=i.map(function(a){return new THREE.Vector3(a[d],a[e],a[h])}),o=new THREE.Quaternion(a.x,a.y,a.z,0);return{points:n,generator:o}},o=n(i);a.call(this,o.points,o.generator,d,0,2*Math.PI,c)}return __extends(b,a),b}(a.RevolutionGeometry);a.ArrowGeometry=b}(visual||(visual={}));var visual;!function(a){var b=function(a){function b(b,c){this.geometry=b,this.material=c,a.call(this,b,this.material)}return __extends(b,a),Object.defineProperty(b.prototype,"pos",{get:function(){var a=this.position;return new blade.Euclidean3(0,a.x,a.y,a.z,0,0,0,0)},set:function(a){this.position.set(a.x,a.y,a.z)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"attitude",{get:function(){var a=this.quaternion;return new blade.Euclidean3(a.w,0,0,0,-a.z,-a.x,-a.y,0)},set:function(a){this.quaternion.set(-a.yz,-a.zx,-a.xy,a.w)},enumerable:!0,configurable:!0}),b}(THREE.Mesh);a.Mesh=b}(visual||(visual={}));var visual;!function(a){var b=function(b){function c(c){c=c||{};var d=c.scale||1,e=new THREE.Quaternion(0,0,0,1),f=void 0,g=1*d,h=.01*d,i=.08*d,j=.2*d,k=c.axis||{x:0,y:0,z:1};c.color="number"==typeof c.color?c.color:16776960,c.opacity="number"==typeof c.opacity?c.opacity:1,c.transparent="boolean"==typeof c.transparent?c.transparent:!1;var l=new THREE.MeshLambertMaterial({color:c.color,opacity:c.opacity,transparent:c.transparent});b.call(this,new a.ArrowGeometry(d,e,f,g,h,i,j,k),l)}return __extends(c,b),c}(a.Mesh);a.Arrow=b}(visual||(visual={}));var visual;!function(a){var b=function(a){function b(b){b=b||{},b.width=b.width||1,b.height=b.height||1,b.depth=b.depth||1,b.color="number"==typeof b.color?b.color:16711680,b.opacity="number"==typeof b.opacity?b.opacity:1,b.transparent="boolean"==typeof b.transparent?b.transparent:!1;var c=new THREE.MeshLambertMaterial({color:b.color,opacity:b.opacity,transparent:b.transparent});a.call(this,new THREE.BoxGeometry(b.width,b.height,b.depth),c)}return __extends(b,a),b}(a.Mesh);a.Box=b}(visual||(visual={}));var visual;!function(a){var b=function(a){function b(b){b=b||{},b.radius=b.radius||1,b.widthSegments=b.widthSegments||24,b.heightSegments=b.heightSegments||18,b.color="number"==typeof b.color?b.color:255,b.opacity="number"==typeof b.opacity?b.opacity:1,b.transparent="boolean"==typeof b.transparent?b.transparent:!1;var c=new THREE.MeshLambertMaterial({color:b.color,opacity:b.opacity,transparent:b.transparent});a.call(this,new THREE.SphereGeometry(b.radius,b.widthSegments,b.heightSegments,b.phiStart,b.phiLength,b.thetaStart,b.thetaLength),c)}return __extends(b,a),b}(a.Mesh);a.Sphere=b}(visual||(visual={}));var visual;!function(a){var b=function(a){function b(b,c,d,e,f,g,h){function i(a,b){var c=b%k;if(c===k-1)return i(a,b-1);var d=(b-c)/k;return s*(d+c*t)}function j(a){var b=a%k;return b===k-1?c:d}a.call(this);var k=9;b=b||1,c=c||.08,d=d||.01,e=e||.2,f=f||.8,g=g||8;var l=g*k;h=h||12;for(var m=2*Math.PI,n=b,o=new THREE.Vector3,p=[],q=[],r=f/(e+f),s=m/g,t=r/(k-2),u=0;h>=u;u++)for(var v=m*u/h,w=Math.cos(v),x=Math.sin(v),y=0;l>=y;y++){var z=i(l,y),A=Math.cos(z),B=Math.sin(z);o.x=n*A,o.y=n*B;var C=new THREE.Vector3,D=j(y);C.x=(n+D*w)*A,C.y=(n+D*w)*B,C.z=D*x,this.vertices.push(C),p.push(new THREE.Vector2(y/l,u/h)),q.push(C.clone().sub(o).normalize())}for(var u=1;h>=u;u++)for(var y=1;l>=y;y++){var E=(l+1)*u+y-1,F=(l+1)*(u-1)+y-1,G=(l+1)*(u-1)+y,H=(l+1)*u+y,I=new THREE.Face3(E,F,H,[q[E],q[F],q[H]]);I.normal.add(q[E]),I.normal.add(q[F]),I.normal.add(q[H]),I.normal.normalize(),this.faces.push(I),this.faceVertexUvs[0].push([p[E].clone(),p[F].clone(),p[H].clone()]),I=new THREE.Face3(F,G,H,[q[F],q[G],q[H]]),I.normal.add(q[F]),I.normal.add(q[G]),I.normal.add(q[H]),I.normal.normalize(),this.faces.push(I),this.faceVertexUvs[0].push([p[F].clone(),p[G].clone(),p[H].clone()])}}return __extends(b,a),b}(THREE.Geometry);a.VortexGeometry=b}(visual||(visual={}));var visual;!function(a){var b=function(b){function c(c){c=c||{radius:1,radiusCone:.08,color:65280,opacity:1,transparent:!1},c.radius=c.radius||1,c.radiusCone=c.radiusCone||.08,c.color="number"==typeof c.color?c.color:65280,c.opacity="number"==typeof c.opacity?c.opacity:1,c.transparent="boolean"==typeof c.transparent?c.transparent:!1;var d=new THREE.MeshLambertMaterial({color:c.color,opacity:c.opacity,transparent:c.transparent});b.call(this,new a.VortexGeometry(c.radius,c.radiusCone,.01,.02,.075),d)}return __extends(c,b),c}(a.Mesh);a.Vortex=b}(visual||(visual={}));var visual;!function(a){function b(a,b){for(var c=a.getElementsByTagName(b),d=c.length-1;d>=0;d--){var e=c[d];e.parentNode.removeChild(e)}}var c=function(){function a(a,b){function c(c){var d=b.innerWidth,e=b.innerHeight;a.width=d,a.height=e}this.canvas=a,this.wnd=b,this.sizer=c}return a.prototype.setSize=function(a,b){this.canvas.width=a,this.canvas.height=b},a.prototype.setUp=function(){this.wnd.document.body.insertBefore(this.canvas,this.wnd.document.body.firstChild),this.wnd.addEventListener("resize",this.sizer,!1),this.sizer(null)},a.prototype.tearDown=function(){this.wnd.removeEventListener("resize",this.sizer,!1),b(this.wnd.document,"canvas")},a}();a.Workbench2D=c}(visual||(visual={}));var visual;!function(a){function b(a,b){for(var c=a.getElementsByTagName(b),d=c.length-1;d>=0;d--){var e=c[d];e.parentNode.removeChild(e)}}var c=function(){function a(a,b,c,d){function e(a){var b=d.innerWidth,c=d.innerHeight;f.setSize(b,c)}this.canvas=a,this.renderer=b,this.camera=c,this.wnd=d;var f=this;this.sizer=e}return a.prototype.setSize=function(a,b){this.renderer.setSize(a,b),this.camera.aspect=a/b,this.camera.updateProjectionMatrix()},a.prototype.setUp=function(){this.wnd.document.body.insertBefore(this.canvas,this.wnd.document.body.firstChild),this.wnd.addEventListener("resize",this.sizer,!1),this.sizer(null)},a.prototype.tearDown=function(){this.wnd.removeEventListener("resize",this.sizer,!1),b(this.wnd.document,"canvas")},a}();a.Workbench3D=c}(visual||(visual={}));var visual;!function(a){var b=function(){function b(b,c){if(this.scene=new THREE.Scene,this.camera=new THREE.PerspectiveCamera(45,1,.1,1e4),this.camera.position.set(0,-5,0),this.camera.up.set(0,0,1),this.camera.lookAt(this.scene.position),"string"==typeof c){if(this.canvas3D=document.getElementById(c),!this.canvas3D)throw new Error(c+" is not a valid canvas element identifier.");this.renderer=new THREE.WebGLRenderer({canvas:this.canvas3D})}else"object"==typeof c?(this.canvas3D=c,this.renderer=new THREE.WebGLRenderer({canvas:c})):(this.renderer=new THREE.WebGLRenderer,this.canvas3D=this.renderer.domElement);this.workbench3D=new a.Workbench3D(this.canvas3D,this.renderer,this.camera,b),this.canvas2D=b.document.createElement("canvas"),this.canvas2D.style.position="absolute",this.canvas2D.style.top="0px",this.canvas2D.style.left="0px",this.workbench2D=new a.Workbench2D(this.canvas2D,b),"undefined"!=typeof createjs&&(this.stage=new createjs.Stage(this.canvas2D),this.stage.autoClear=!0)}return Object.defineProperty(b.prototype,"width",{get:function(){return this.canvas3D.width},set:function(a){this.canvas3D.width=a,this.canvas2D.width=a,this.workbench3D.setSize(a,this.canvas3D.height),this.workbench2D.setSize(a,this.canvas3D.height)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"height",{get:function(){return this.canvas3D.height},set:function(a){this.canvas3D.height=a,this.canvas2D.height=a,this.workbench3D.setSize(this.canvas3D.width,a),this.workbench2D.setSize(this.canvas3D.width,a)},enumerable:!0,configurable:!0}),b.prototype.add=function(a){return this.scene.add(a)},b.prototype.remove=function(a){return this.scene.remove(a)},b.prototype.setSize=function(a,b){this.workbench3D.setSize(a,b),this.workbench2D.setSize(a,b)},b.prototype.setUp=function(){this.workbench3D.setUp(),this.workbench2D.setUp()},b.prototype.tearDown=function(){this.workbench3D.tearDown(),this.workbench2D.tearDown()},b.prototype.update=function(){this.renderer.render(this.scene,this.camera),this.stage&&this.stage.update()},b}();a.WebGLCanvas=b}(visual||(visual={}));var visual;!function(a){function b(a,b,c,d,e){var f=1,g=2,h=3,i=!1,j=void 0,k=0,l=1e3,m=null,n=void 0,o=f,p=function(c){if(j&&(k=k+c-j),j=c,i||b(k/l)){i=!1,e.cancelAnimationFrame(m),r.isRunning?(o=h,j=void 0):console.error("stopSignal received while not running."),e.document.removeEventListener("keydown",q,!1);try{d(n)}catch(f){console.log("Exception thrown from tearDown function: "+f)}}else{m=e.requestAnimationFrame(p);try{a(k/l)}catch(f){n=f,i=!0}}},q=function(a){27===a.keyCode&&(i=!0,a.preventDefault())},r={start:function(){if(r.isRunning)throw new Error("The `start` method may only be called when not running.");c(),e.document.addEventListener("keydown",q,!1),o=g,m=e.requestAnimationFrame(p)},stop:function(){if(!r.isRunning)throw new Error("The `stop` method may only be called when running.");i=!0},reset:function(){if(!r.isPaused)throw new Error("The `reset` method may only be called when paused.");j=void 0,k=0,o=f},get time(){return k/l},lap:function(){if(!r.isRunning)throw new Error("The `lap` method may only be called when running.")},get isRunning(){return o===g},get isPaused(){return o===h}};return r}a.animationRunner=b}(visual||(visual={}));var visual;!function(a){function b(a){return new blade.Euclidean3(a,0,0,0,0,0,0,0)}function c(a,b,c){return new blade.Euclidean3(0,a,b,c,0,0,0,0)}function d(a,b,c){return new blade.Euclidean3(0,0,0,0,a,b,c,0)}function e(a){return new blade.Euclidean3(0,0,0,0,0,0,0,a)}a.VERSION="1.5.0",a.scalarE3=b,a.vectorE3=c,a.bivectorE3=d,a.pseudoE3=e}(visual||(visual={}));